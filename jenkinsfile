pipeline{
    agent{label 'any'}
    stages{
        stage('copying the code'){
            step{
                echo "copying the code"
            }
        }

        stage('building the code'){
            step{
                echo "building the code "
                sh 'docker build -t local_mate:latest .'
            }
        }

        stage('building docker network'){
            step{
                echo "building docker network"
                sh 'docker network create local_mate_network || true'
            }
        }


        stage('deploying the code'){
            step{
                echo "this is deploying the code"
                sh "docker run -d --name local_mate-container --network local_mate_network -p 8000:8000 local_mate:latest"
            }
        }
        stage('deploying nginx'){
            step{
                echo "this is deploying nginx"
                sh 'docker run -d --name nginx-container --network local_mate_network -p 80:80 -v nginx:latest'
            }
        }
    }
}